#!/bin/sh

echo "üîç V√©rification du code..."

# V√©rifier si des fichiers sont stag√©s
if git diff --cached --quiet; then
    echo "‚ùå Aucun fichier n'est stag√© pour le commit"
    exit 1
fi

# Sauvegarder les fichiers modifi√©s non stag√©s
git stash -q --keep-index

# V√©rifier le linting
echo "üßπ V√©rification du linting..."
npm run lint
LINT_RESULT=$?

# V√©rifier les types TypeScript
echo "üìù V√©rification des types TypeScript..."
npm run type-check
TS_RESULT=$?

# Restaurer les fichiers modifi√©s non stag√©s
git stash pop -q

# V√©rifier les r√©sultats
if [ $LINT_RESULT -ne 0 ]; then
    echo "‚ùå Le linting a √©chou√©"
    exit 1
fi

if [ $TS_RESULT -ne 0 ]; then
    echo "‚ùå La v√©rification des types a √©chou√©"
    exit 1
fi

echo "‚úÖ V√©rifications r√©ussies !"
exit 0
